# MOBER: Adversarial Conditional Variational Autoencoder for Robust Gene Expression Embeddings

This repository contains a code for reproducing the method introduced in the paper titled 'Biologically relevant integration of transcriptomics profiles from cancer cell lines, patient-derived xenografts and clinical tumors using deep learning'
by : Slavica Dimitrieva, Rens Janssen1, Gang Li, Artur Szalata1,  Raja Gopal, Chintan Parmar,  
Audrey Kauffmann1 and Eric Y. Durand.

## Introduction

MOBER is an adversarial conditional variational autoencoder (VAE) that generates biologically informative gene expression embeddings robust to confounders. It consists of two neural networks: a conditional VAE optimized to generate embeddings that can reconstruct the original input, and an adversarial neural network (aNN) that predicts the origin of the input data based on the embeddings generated by the VAE.

## Method Overview

- **Conditional Variational Autoencoder (VAE)**: The VAE consists of an encoder that encodes a gene expression profile of a sample into a low-dimensional latent space, and a decoder that reconstructs the gene expression profile from the latent space and sample labels.

- **Adversarial Neural Network (aNN)**: The aNN takes the embeddings generated by the VAE as input and predicts the origin of the input data. The goal is to learn an embedding space that encodes information about the input samples while not encoding information about their origin.

- **Training Process**: The VAE and aNN are trained simultaneously. The VAE tries to reconstruct the data while preventing the aNN from accurately predicting the data source. This leads to the VAE generating embeddings that contain no information about the origin of the input data, while the aNN converges to random prediction performance.

## Usage

To use MOBER for projecting transcriptomics profiles from one origin to another:

1. Train the MOBER model using the provided code and datasets.
2. Pass the transcriptomics profile through the trained VAE.
3. Change the one-hot vector informing on the sample origin to the desired one.
4. Decode the transcriptomics profile as if it were from the desired origin.

## Example Usage
There is a Jupyter notebook called example_usage.ipynb which presents the typical workflow and usage of the code.

## Data Files

Download the necessary data files using the following links:

- [ACH Data](https://depmap.org/portal/)
- [TCGA Data](https://xena.treehouse.gi.ucsc.edu/download/TumorCompendium_v11_PolyA_hugo_log2tpm_58581genes_2020-04-09.tsv)
- [TCGA Projects](https://drive.google.com/file/d/186omJbPmclVJ2gNSVlwBPU3LI540HpwS/view?usp=sharing)
- [ACH Metadata](https://depmap.org/portal/)
- [TCGA Metadata](https://xena.treehouse.gi.ucsc.edu/download/TumorCompendium_v11_PolyA_hugo_log2tpm_58581genes_2020-04-09.tsv.json)
- [L1000 genes list](https://drive.google.com/file/d/19xhBJ49XonbkpwTDtOmJw7NyJWwJnZ8P/view?usp=sharing)
- [ACH GDSC Indexes](https://drive.google.com/file/d/13aNLsZ9Ff5z1r8_T1TxBi5ZYSHiquQHq/view?usp=sharing)

## Requirements

- Python (version X.X.X)
- PyTorch (version X.X.X)
- [Other dependencies]

## Contributing

Contributions are welcome! 

## License



## Acknowledgements


